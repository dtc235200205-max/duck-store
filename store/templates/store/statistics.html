{% extends 'store/base.html' %}

{% block title %}Thống kê - Duck Store{% endblock %}

{% block content %}
<h2 style="font-weight: 800;">
    <i class="fas fa-chart-line me-2"></i>Thống kê bán hàng
</h2>

<div class="row mt-4 g-3">
    <div class="col-md-4">
        <div class="card text-white" style="background: linear-gradient(135deg, var(--success) 0%, #059669 100%);">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-money-bill-wave me-2"></i>Tổng doanh thu</h5>
                <p class="display-5" style="font-weight: 800;">{{ total_revenue|floatformat:0 }}K</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white" style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-shopping-bag me-2"></i>Tổng đơn hàng</h5>
                <p class="display-5" style="font-weight: 800;">{{ total_orders }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card text-white" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-calculator me-2"></i>Giá trị trung bình</h5>
                {% if total_orders > 0 %}
                {% widthratio total_revenue total_orders 1 as avg_value %}
                <p class="display-5" style="font-weight: 800;">{{ avg_value|floatformat:0 }}K</p>
                {% else %}
                <p class="display-5">0K</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card mt-4" style="border-radius: 1.2rem;">
    <div class="card-header" style="background-color: var(--light-bg); border-radius: 1.2rem 1.2rem 0 0;">
        <h5 style="font-weight: 700;">
            <i class="fas fa-star me-2"></i>Sản phẩm bán chạy nhất
        </h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th style="font-weight: 700;"><i class="fas fa-box me-2"></i>Tên sản phẩm</th>
                        <th style="font-weight: 700;"><i class="fas fa-folder me-2"></i>Danh mục</th>
                        <th style="font-weight: 700;"><i class="fas fa-money-bill-wave me-2"></i>Giá</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in top_products %}
                    <tr>
                        <td><strong>{{ product.name }}</strong></td>
                        <td>{{ product.category.name }}</td>
                        <td><span style="color: var(--danger); font-weight: 700;">{{ product.price }}K</span></td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" class="text-center text-muted py-3">
                            <i class="fas fa-inbox me-2"></i>Chưa có dữ liệu sản phẩm
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}